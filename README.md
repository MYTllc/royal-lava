
# Royal-Lava <img src="https://cdn.discordapp.com/avatars/1348283470371094619/6fa8ec5e19ce5fbcc65b690a3a42e24d.webp?size=40" align="right" alt="Lavalink Logo"/>

![alt text](https://img.shields.io/npm/v/royal-lava?style=for-the-badge&logo=npm)  
![alt text](https://img.shields.io/npm/dt/royal-lava?style=for-the-badge&logo=npm)  
![alt text](https://cdn.discordapp.com/avatars/1348283470371094619/6fa8ec5e19ce5fbcc65b690a3a42e24d.webp?size=4096)  

**Royal-Lava** ูู ุฃูู ููุชุจุฉ Lavalink v4 ูุจุฑูุฌุฉ ูู ูุจู ูุจุฑูุฌ ุนุฑุจู ูู ุงูุนุฑุงูุ  
ููู ููุชุจุฉ ูููุฉ ููุชุทูุฑุฉ ุชุชูุญ ูู ุจูุงุก ุจูุชุงุช ููุณููู ูุชูุฏูุฉ ูุฏูุณููุฑุฏุ ูุน ุงูุชุฑููุฒ ุนูู ุงูุงุณุชูุฑุงุฑ ูุฅุฏุงุฑุฉ ุงูุนูุฏ ุงููุชุนุฏุฏุฉ ูุงุณุชุฆูุงู ุงูุฌูุณุงุช ููุธุงู ูุงุฆูุฉ ุชุดุบูู ููู.

---

## โจ ุงููููุฒุงุช  

๐ **ุฏุนู Lavalink v4 ุจุงููุงูู**  
ูุชูุงููุฉ ูุน ูุงุฌูุงุช REST ู WebSocket ุงูุฎุงุตุฉ ุจู Lavalink v4.

๐ **ุฅุฏุงุฑุฉ ูุชุนุฏุฏุฉ ููุนูุฏ**  
- ุงูุงุชุตุงู ุจุนุฏุฉ ุนูุฏ Lavalink ูุฅุฏุงุฑุชูุง ูู ููุช ูุงุญุฏ.  
- ุงุฎุชูุงุฑ ุงูุนูุฏุฉ ุงูุฃูุถู ุชููุงุฆููุง ุจูุงุกู ุนูู ุงูุฃุฏุงุก (ุงููุนุงูุฌุ ุงูุฐุงูุฑุฉุ ุนุฏุฏ ุงููุดุบูุงุช).  
- ุฅุถุงูุฉ ูุฅุฒุงูุฉ ุงูุนูุฏ ุฃุซูุงุก ุงูุชุดุบูู.  

๐ **ุฅุนุงุฏุฉ ุงูุงุชุตุงู ุงููููุฉ**  
- ุฅุนุงุฏุฉ ุงูุงุชุตุงู ุชููุงุฆููุง ูู ุญุงูุฉ ุฅุบูุงู WebSocket ุบูุฑ ุงููุชููุน.  
- ุงุณุชุฑุงุชูุฌูุงุช ูุชูุฏูุฉ ููุญุฏ ูู ุนูููุงุช ุฅุนุงุฏุฉ ุงูุงุชุตุงู ุงูุนุดูุงุฆูุฉ.  
- ุนุฏุฏ ูุญุงููุงุช ุฅุนุงุฏุฉ ุงูุงุชุตุงู ูุงุจู ููุชุฎุตูุต.  

๐ **ุงุณุชุฆูุงู ุงูุฌูุณุงุช**  
- ุงุณุชุบูุงู ููุฒุฉ ุงุณุชุฆูุงู ุงูุฌูุณุงุช ูู Lavalink v4 ูุงุณุชุนุงุฏุฉ ุงูุญุงูุฉ ุจุณุฑุนุฉ ุจุนุฏ ุงููุทุงุน ูุตูุฑ.  
- ุฎูุงุฑุงุช ูุงุจูุฉ ููุชุฎุตูุต ูููุชุงุญ ุงูุงุณุชุฆูุงู ููุชุฑุฉ ุงููููุฉ.  

๐ถ **ุชุญูู ูุชูุฏู ูู ุงููุดุบู**  
- `play()`: ุชุดุบูู ุงููุณุงุฑุงุช ูุน ุฎูุงุฑุงุช ูุชุนุฏุฏุฉ (ุชูููุช ุงูุจุฏุก/ุงูุงูุชูุงุกุ ุงูุฅููุงู ุงููุคูุชุ ุงูุงุณุชุจุฏุงู).  
- `stop()`: ุฅููุงู ุงูุชุดุบูู ูุฅููุงููุฉ ูุณุญ ุงููุงุฆูุฉ.  
- `pause() / resume()`: ุฅููุงู ุฃู ุงุณุชุฆูุงู ุงูุชุดุบูู.  
- `skip()`: ุชุฎุทู ุงููุณุงุฑ ุงูุญุงูู.  
- `seek()`: ุงูุงูุชูุงู ุฅูู ููุทุฉ ูุนููุฉ ูู ุงููุณุงุฑ.  
- `setVolume()`: ุถุจุท ูุณุชูู ุงูุตูุช ุจูู 0-1000.  
- `setLoop()`: ุชุนููู ูุถุน ุงูุชูุฑุงุฑ (ูุง ุดูุกุ ูุณุงุฑุ ูุงุฆูุฉ).  

๐ถ **ูุธุงู ูุงุฆูุฉ ุชุดุบูู ูุชุทูุฑ**  
- ุฅุถุงูุฉ ูุณุงุฑ ูุงุญุฏ ุฃู ูุชุนุฏุฏ ุฅูู ุงููุงุฆูุฉ.  
- ุฅุฏุฑุงุฌ ูุณุงุฑุงุช ูู ููุงูุน ูุนููุฉ.  
- ุงุณุชุฑุฌุงุน ุงููุณุงุฑ ุงูุชุงูู ุชููุงุฆููุง ูุฅุฏุงุฑุฉ ุงูุชูุฑุงุฑ.  
- ุฅุฒุงูุฉ ุงููุณุงุฑุงุช ุจูุงุณุทุฉ ุงูููุฑุณ ุฃู ุงููุงุฆู.  
- ูุณุญ ุงููุงุฆูุฉ ุจุงููุงูู.  
- ุฎูุท ุชุฑุชูุจ ุงููุณุงุฑุงุช.  
- ุชุชุจุน ุงููุณุงุฑุงุช ุงูุณุงุจูุฉ ูู history.  

๐ **ุชูุงูู ุณูุณ ูุน Discord**  
- ูุชูุงูู ูุน ููุชุจุงุช Discord ูุซู discord.js ู eris.  
- ูุชุทูุจ ุชูููุฑ ุฏุงูุฉ ูุฅุฑุณุงู ุญุฒู ุงูุตูุช ุฅูู ุจูุงุจุฉ Discord.  
- ูุฏูุฑ ุญุงูุฉ ุงุชุตุงู ุงูุตูุช ุชููุงุฆููุง.  

โ๏ธ **ููู ุงููุดุบู ุจูู ุงูุนูุฏ**  
- `player.moveToNode(newNode)`: ููู ูุดุบู ูุดุท ูู ุนูุฏุฉ ุฅูู ุฃุฎุฑู ุจุฏูู ุงููุทุงุนุ ูููุฏ ูุตูุงูุฉ ุงูุนูุฏ.  

๐ฅ **ูุธุงู ุฃุญุฏุงุซ ููู**  
- ูุตุฏุฑ ูุฌููุนุฉ ูุงุณุนุฉ ูู ุงูุฃุญุฏุงุซ ููุฑุงูุจุฉ ุงูุนูููุงุช ูุชูููุฐ ุงูููุทู ุงููุฎุตุต.  

๐ก **ุชุฌุฑูุฏ ูุงุฌูุฉ REST**  
- ูููุฑ ุทุฑููุง ูุธููุฉ ููุชูุงุนู ูุน REST API ุงูุฎุงุต ุจู Lavalink.  
- ูุดูู ุขููุงุช ุฅุนุงุฏุฉ ุงููุญุงููุฉ ุนูุฏ ุญุฏูุซ ูููุงุช.  

---

## ๐ ุงููุชุทูุจุงุช  
- Node.js v20.0.0 ุฃู ุฃุญุฏุซ  
- NPM ุฃู Yarn  
- ุฎุงุฏู Lavalink v4 ููุฏ ุงูุชุดุบูู  

## ๐ง ุงูุชุซุจูุช  

```bash
npm install royal-lava
# ุฃู
yarn add royal-lava
```

**ุชุญุชุงุฌ ุฃูุถูุง ุฅูู ููุชุจุฉ Discord (ูุซู discord.js) ูุญุฒูุฉ ws.**  

```bash
npm install discord.js ws
# ุฃู
yarn add discord.js ws
```

---

## ๐ ูุซุงู ููุงุณุชุฎุฏุงู ุงูุฃุณุงุณู ูุน Discord.js  

```js
// ุงุณุชูุฑุงุฏ ุงูููุชุจุงุช ุงููุงุฒูุฉ
const { Manager, Constants } = require('royal-lava');
const { Client, GatewayIntentBits, Partials, Events } = require('discord.js'); // ุงุณุชุฎุฏู discord.js v14+

// --- ุฅุนุฏุงุฏ ุนููู ุฏูุณููุฑุฏ ---
const client = new Client({
    intents: [
        GatewayIntentBits.Guilds,
        GatewayIntentBits.GuildVoiceStates,
        GatewayIntentBits.GuildMessages, // ุฃุถููุง ุฅุฐุง ูุงูุช ูุทููุจุฉ ููุฃูุงูุฑ
        GatewayIntentBits.MessageContent, // ุฃุถููุง ุฅุฐุง ูุงูุช ูุทููุจุฉ ููุฃูุงูุฑ ุงููุตูุฉ (prefix)
    ],
    partials: [Partials.Channel], // ูุฏ ุชููู ูุทููุจุฉ ููุชูุงุนู ูู ุงูุฑุณุงุฆู ุงูุฎุงุตุฉุ ุชุญูู ูู ุงุญุชูุงุฌุงุชู
});

// --- ุฅุนุฏุงุฏุงุช ุณูุฑูุฑุงุช Lavalink ---
const nodes = [
    {
        host: 'localhost',         // ุนููุงู ุณูุฑูุฑ Lavalink ุงูุฎุงุต ุจู
        port: 2333,                // ูููุฐ WebSocket ูุณูุฑูุฑ Lavalink ุงูุฎุงุต ุจู
        password: 'youshallnotpass', // ูููุฉ ูุฑูุฑ ุณูุฑูุฑ Lavalink ุงูุฎุงุต ุจู
        identifier: 'Main Node',   // ูุนุฑู ุงุฎุชูุงุฑู ููุณูุฑูุฑ
        secure: false,             // ุงุฌุนููุง true ูุงุชุตุงูุงุช WSS ุงูุขููุฉ
        resumeKey: `royal-lava-example-${process.pid}`, // ูุซุงู ูููุชุงุญ ุงุณุชุฆูุงู ูุฑูุฏ
        resumeTimeout: 60,        // ูููุฉ ุงูุงุณุชุฆูุงู ุจุงูุซูุงูู
        // ุงุฎุชูุงุฑู: ุฅุนุฏุงุฏุงุช ุฅุนุงุฏุฉ ุงููุญุงููุฉ ูุทูุจุงุช REST (ูุฎุชููุฉ ุนู ุฅุนุงุฏุฉ ุงุชุตุงู WS)
        retryAmount: 3,            // ุนุฏุฏ ูุญุงููุงุช ุฅุนุงุฏุฉ ุทูุจ REST
        // retryDelay: 500,      // ุชุฃุฎูุฑ ุฃููู ุจุงููููู ุซุงููุฉ ูุฅุนุงุฏุฉ ุทูุจุงุช REST (ููุณ ูู ุงูููุฏ ุงูุญุงูู ููู ูููู ุฅุถุงูุชู ูู Rest.js)
    },
    // ุฃุถู ุงููุฒูุฏ ูู ุงูุณูุฑูุฑุงุช ููุง ุฅุฐุง ููุช ุชุดุบู ุนุฏุฉ ูุณุฎ ูู Lavalink
];

// --- ุฅูุดุงุก ูุฏูุฑ Royal-Lava ---
client.lavalink = new Manager({
    // ููููู ุชูุฑูุฑ ุฅุนุฏุงุฏุงุช ุงูุณูุฑูุฑุงุช ููุงุ ูููู addNode ุจุนุฏ ุงูุฅูุดุงุก ูู ุงูุฃูุถู ุงูุขู
    nodes: [], // ูุจุฏุฃ ูุงุฑุบูุง ููุชู ุงูุฅุถุงูุฉ ูุงุญููุง ุฃู ูุจุงุดุฑุฉ ุจู addNode
    userId: null, // ุณูุชู ุชุนูููู ูู ุญุฏุซ 'ready' ููุนููู
    send: (guildId, payload) => {
        // ุฏุงูุฉ ุฎุงุตุฉ ุจู ูุฅุฑุณุงู ุงูุจูุงูุงุช ุงูุฎุงู (payloads) ูุจูุงุจุฉ ุฏูุณููุฑุฏ
        const guild = client.guilds.cache.get(guildId);
        // ุงุณุชุฎุฏู ุฎุงุตูุฉ 'ws' ูู discord.js v14+ ููุดุงุฑุฏูุฌ ุงูุฏุงุฎูู ุฃู ุนุฏู ุญุณุจ ุงูุญุงุฌุฉ
        if (guild?.shard?.ws?.readyState === 1 /* WebSocket.OPEN */ ) {
             guild.shard.send(payload);
         } else if (client.ws?.shards?.get(guild?.shardId)?.ws?.readyState === 1) {
            // ุญู ุจุฏูู ูู ุญุงูุฉ ุงูุดุงุฑุฏ ุงููุงุญุฏ ุฃู ุฅุนุฏุงุฏ ูุฎุชูู
            client.ws.shards.get(guild.shardId)?.send(payload);
         } else {
             // console.warn(`[Lavalink SEND] ุชุนุฐุฑ ุงูุนุซูุฑ ุนูู WS ูุดุท ููุดุงุฑุฏ ููุณูุฑูุฑ ${guildId}`);
         }
    },
    playerOptions: {
        // ุฅุนุฏุงุฏุงุช ุงูุชุฑุงุถูุฉ ูููุดุบูุงุช ุงูุชู ูุชู ุฅูุดุงุคูุง ุจูุงุณุทุฉ ูุฐุง ุงููุฏูุฑ
        initialVolume: 80,
        selfDeaf: true, // ููุถู ุฌุนู ุงูุจูุช ุฃุตููุง ูู ุงููููุงุช ุงูุตูุชูุฉ
    },
});

// --- ุชููุฆุฉ ุงูุณูุฑูุฑุงุช ุจุนุฏ ุฅูุดุงุก ุงููุฏูุฑ ูุชุญุฏูุฏ ูููุฉ ุงูุจูุช ---
client.once(Events.ClientReady, () => {
    console.log(`ุชู ุชุณุฌูู ุงูุฏุฎูู ูู ${client.user.tag}!`);
    // ูุงู: ูู ุจุชุนููู ูุนุฑูู ุงููุณุชุฎุฏู (userId) ูููุฏูุฑ ุจุนุฏ ุฃู ูุตุจุญ ุงูุนููู ุฌุงูุฒูุง
    client.lavalink.userId = client.user.id;
    console.log(`ุชู ุชููุฆุฉ ูุฏูุฑ Lavalink ููุนุฑู ุงููุณุชุฎุฏู: ${client.lavalink.userId}`);

    // ูู ุจุฅุถุงูุฉ ูุชููุฆุฉ ุงูุณูุฑูุฑุงุช ุงูุขู ุจุนุฏ ุงูุญุตูู ุนูู userId
    nodes.forEach(nodeConfig => {
        try {
            client.lavalink.addNode(nodeConfig);
        } catch (err) {
            console.error(`ูุดู ูู ุฅุถุงูุฉ ุงูุณูุฑูุฑ ${nodeConfig.identifier || nodeConfig.host}:`, err);
        }
    });
});


// --- ูุณุชูุนู ุฃุญุฏุงุซ Royal-Lava ---
client.lavalink.on(Constants.CLIENT_EVENT_TYPES.NODE_CONNECT, node => {
    console.log(`[Lava Node Connect] ุงูุณูุฑูุฑ "${node.identifier}" ูุชุตู.`);
});

client.lavalink.on(Constants.CLIENT_EVENT_TYPES.NODE_READY, node => {
    console.log(`[Lava Node Ready] ุงูุณูุฑูุฑ "${node.identifier}" ุฌุงูุฒ. Session ID: ${node.sessionId}`);
});

client.lavalink.on(Constants.CLIENT_EVENT_TYPES.NODE_ERROR, (node, error, context) => {
    console.error(`[Lava Node Error] ุฎุทุฃ ูู ุงูุณูุฑูุฑ "${node.identifier}": ${error.message}`, context || '');
});

client.lavalink.on(Constants.CLIENT_EVENT_TYPES.NODE_DISCONNECT, (node, code, reason) => {
    console.warn(`[Lava Node Disconnect] ุงููุทุน ุงุชุตุงู ุงูุณูุฑูุฑ "${node.identifier}". ุงูุฑูุฒ: ${code}, ุงูุณุจุจ: ${reason || 'ูุง ููุฌุฏ ุณุจุจ'}`);
});

client.lavalink.on(Constants.CLIENT_EVENT_TYPES.TRACK_START, (player, track) => {
    console.log(`[Lava Player ${player.guildId}] ุจุฏุก ุชุดุบูู: ${track.info.title}`);
    // ูุซุงู: ุฅุฑุณุงู ุฑุณุงูุฉ ุฅูู ููุงุฉ ูุตูุฉ ูู ุฏูุณููุฑุฏ
    // const channel = client.channels.cache.get('YOUR_TEXT_CHANNEL_ID');
    // channel?.send(`๐ฟ ุงูุขู ูุชู ุชุดุบูู: **${track.info.title}** ุจูุงุณุทุฉ ${track.info.author}`);
});

client.lavalink.on(Constants.CLIENT_EVENT_TYPES.TRACK_END, (player, track, payload) => {
    console.log(`[Lava Player ${player.guildId}] ุงูุชูุงุก ุงูุฃุบููุฉ. ุงูุณุจุจ: ${payload.reason}`);
    // track ูุฏ ูููู null ุฅุฐุง ุชู ุฅููุงูู ูุฏูููุง ุฃู ูุดู ุชุญููู ุงูุฃุบููุฉ ุงูุชุงููุฉ
});

client.lavalink.on(Constants.CLIENT_EVENT_TYPES.QUEUE_END, (player) => {
    console.log(`[Lava Player ${player.guildId}] ุงูุชูุงุก ูุงุฆูุฉ ุงูุงูุชุธุงุฑ.`);
    // ูุซุงู: ูุบุงุฏุฑุฉ ุงูููุงุฉ ุงูุตูุชูุฉ ุจุนุฏ ูุชุฑุฉ ูู ุนุฏู ุงููุดุงุท
    // setTimeout(() => {
    //     if (!player.playing && player.queue.isEmpty && player.connected) {
    //         player.disconnect();
    //         // ุฅุฑุณุงู ุฑุณุงูุฉ ูุซู "ุชูุช ุงููุบุงุฏุฑุฉ ุจุณุจุจ ุนุฏู ุงููุดุงุท."
    //     }
    // }, 60 * 1000); // 60 ุซุงููุฉ
});

client.lavalink.on(Constants.CLIENT_EVENT_TYPES.PLAYER_WEBSOCKET_CLOSED, (player, payload) => {
     console.error(`[Lava Player ${player.guildId}] ุงูุบูู ุงุชุตุงู WebSocket ูุน ุฏูุณููุฑุฏ! ุงูุฑูุฒ: ${payload.code}`);
     // ููููู ุงูุชุนุงูู ูุน ุฑููุฒ ุงูุฅุบูุงู ุงููุญุฏุฏุฉ ุฅุฐุง ูุฒู ุงูุฃูุฑุ ูุซูุงู ุทูุจ ุฅุนุงุฏุฉ ุงูุงุชุตุงู
 });

client.lavalink.on(Constants.CLIENT_EVENT_TYPES.DEBUG, (message, ...args) => {
    // console.debug("[Lava Debug]", message, ...args); // ูู ุจุฅูุบุงุก ุงูุชุนููู ูุนุฑุถ ุณุฌูุงุช ุงูุชุตุญูุญ ุงูููุตูุฉ
});


// --- ูุณุชูุนู ุฃุญุฏุงุซ ุนููู ุฏูุณููุฑุฏ ---

// ุชูุฑูุฑ ุฃุญุฏุงุซ VOICE_STATE_UPDATE ู VOICE_SERVER_UPDATE ุฅูู royal-lava
client.on(Events.Raw, async (d) => {
    // ุชุญูู ูู ุชููุฆุฉ ุงููุฏูุฑ ูุจู ูุนุงูุฌุฉ ุงูุฃุญุฏุงุซ
     if (client.lavalink?.userId && ['VOICE_STATE_UPDATE', 'VOICE_SERVER_UPDATE'].includes(d.t)) {
        // ุชุญุชุงุฌ ูุชูุฑูุฑ d.d (ุจูุงูุงุช ุงูุญุฏุซ) ููููุนุงูุฌ
        if (d.t === 'VOICE_STATE_UPDATE') {
            try {
                await client.lavalink.handleVoiceStateUpdate(d.d);
             } catch (e) { console.error("[Lava Raw Handle] ุฎุทุฃ ูู ูุนุงูุฌุฉ VSU:", e.message); }
        } else if (d.t === 'VOICE_SERVER_UPDATE') {
             try {
                await client.lavalink.handleVoiceServerUpdate(d.d);
            } catch (e) { console.error("[Lava Raw Handle] ุฎุทุฃ ูู ูุนุงูุฌุฉ VServerU:", e.message); }
         }
     }
 });


// --- ูุซุงู ุนูู ุฃูุฑ /play (ุจุงุณุชุฎุฏุงู ุชูุงุนูุงุช Discord.js) ---
client.on(Events.InteractionCreate, async interaction => {
    if (!interaction.isChatInputCommand() || !interaction.guildId) return;

    const { commandName } = interaction;

    if (commandName === 'play') {
        await interaction.deferReply(); // ุชุฃุฌูู ุงูุฑุฏ ูุฃู ุงูุจุญุซ ูุฏ ูุณุชุบุฑู ุจุนุถ ุงูููุช
        const query = interaction.options.getString('query', true);
        const memberChannel = interaction.member?.voice?.channel;

        if (!memberChannel) {
            return interaction.editReply({ content: 'ูุฌุจ ุฃู ุชููู ูู ููุงุฉ ุตูุชูุฉ ูุชุดุบูู ุงูููุณููู!' });
        }
        // ุชุฃูุฏ ูู ุฃู ุงููุฏูุฑ ุฌุงูุฒ ููุฏูู userId
        if (!client.lavalink?.userId || client.lavalink.nodes.size === 0 || ![...client.lavalink.nodes.values()].some(n => n.connected)) {
             return interaction.editReply({ content: 'ุนูููุงุ ูุธุงู ุงูููุณููู ุบูุฑ ุฌุงูุฒ ุญุงูููุง. ูุฑุฌู ุงููุญุงููุฉ ูุฑุฉ ุฃุฎุฑู ูุงุญููุง.' });
        }

        // ุงูุญุตูู ุนูู ุงููุดุบู ุฃู ุฅูุดุงุคู
        let player = client.lavalink.getPlayer(interaction.guildId);
        const botVoiceChannel = interaction.guild.members.me?.voice?.channel;

        // ุฅุฐุง ูู ููู ููุงู ูุดุบู ุฃู ุชู ุชุฏููุฑู
        if (!player || player.state === Constants.PLAYER_STATE.DESTROYED) {
            // ุฅุฐุง ูุงู ุงูุจูุช ููุฌูุฏูุง ุจุงููุนู ูู ููุงุฉ ุฃุฎุฑูุ ูุง ุชุณูุญ ุจูุญุงููุฉ ุงูุงุชุตุงู
            if (botVoiceChannel && botVoiceChannel.id !== memberChannel.id) {
               return interaction.editReply({ content: `ุฃูุง ุฃููู ุจุชุดุบูู ุงูููุณููู ุจุงููุนู ูู ${botVoiceChannel.name}!` });
           }
            // ุฅูุดุงุก ุงููุดุบู ูุงูุงุชุตุงู
           try {
               player = client.lavalink.createPlayer(interaction.guildId);
               player.connect(memberChannel.id); // ุฏุน Royal-Lava ุชุชููู ุฅุฑุณุงู OP 4
               // ูุง ุญุงุฌุฉ ุนุงุฏุฉู ูุงูุชุธุงุฑ ุฃุฎุทุงุก ุงูุงุชุตุงู ููุง
           } catch (connectError) {
               console.error("ูุดู ูู ุฅูุดุงุก ุงููุดุบู ุฃู ุงูุงุชุตุงู:", connectError);
               await interaction.editReply({ content: `ุญุฏุซ ุฎุทุฃ ุฃุซูุงุก ูุญุงููุฉ ุงูุงุชุตุงู ุจุงูููุงุฉ ุงูุตูุชูุฉ: ${connectError.message}` }).catch(() => {});
               if (player) await player.destroy().catch(() => {}); // ุญุงูู ุชูุธูู ุงููุดุบู ุงููุงุดู
               return;
           }
        } else if (player.voiceChannelId !== memberChannel.id) {
            // ุชุญูู ููุง ุฅุฐุง ูุงู ุงููุณุชุฎุฏู ูุญุงูู ุฅุนุทุงุก ุฃูุฑ ูู ููุงุฉ ูุฎุชููุฉ
           return interaction.editReply({ content: `ูุฌุจ ุฃู ุชููู ูู ููุณ ููุงุชู ุงูุตูุชูุฉ ุงูุญุงููุฉ (${botVoiceChannel?.name ?? 'ุบูุฑ ูุนุฑูู'}) ูุงุณุชุฎุฏุงู ุงูุฃูุงูุฑ!` });
        }
        // ุฅุฐุง ูุงู ุงููุณุชุฎุฏู ูุงูุจูุช ูู ููุณ ุงูููุงุฉุ ุฃู ุชู ุงูุงูุถูุงู ููุชู

        try {
            const searchResult = await client.lavalink.loadTracks(query);

            // ูุนุงูุฌุฉ ุฃุฎุทุงุก ุงูุชุญููู
            if (searchResult.loadType === 'error') {
                console.error("Lavalink Load Error:", searchResult.data);
                throw new Error(`ูุดู ุชุญููู ุงูุฃุบููุฉ: ${searchResult.data?.message || 'ุณุจุจ ุบูุฑ ูุนุฑูู'}`);
           }
            // ูุนุงูุฌุฉ ุนุฏู ูุฌูุฏ ูุชุงุฆุฌ
            if (searchResult.loadType === 'empty') {
                return interaction.editReply({ content: 'ูู ูุชู ุงูุนุซูุฑ ุนูู ุฃู ูุชุงุฆุฌ ูุทูุจู.' });
           }

           let trackToAdd;
           let replyMessage;

            // ูุนุงูุฌุฉ ุงููุชุงุฆุฌ ุงููุฎุชููุฉ
            if (searchResult.loadType === 'playlist') {
                player.queue.add(searchResult.data.tracks);
                replyMessage = `โ ุชูุช ุฅุถุงูุฉ ูุงุฆูุฉ ุงูุชุดุบูู **${searchResult.data.info.name}** (${searchResult.data.tracks.length} ุฃุบููุฉ) ุฅูู ูุงุฆูุฉ ุงูุงูุชุธุงุฑ.`;
            } else {
                // ุฅูุง 'track' ุฃู 'search'
                trackToAdd = searchResult.data?.[0] ?? searchResult.data;
                 if (!trackToAdd || !trackToAdd.info) {
                     console.error("Invalid track data received:", trackToAdd);
                    return interaction.editReply({ content: 'ูุดู ุงูุญุตูู ุนูู ูุนูููุงุช ุงูุฃุบููุฉ ูู ุงููุชูุฌุฉ.' });
                 }
                 player.queue.add(trackToAdd);
                 replyMessage = `โ ุชูุช ุฅุถุงูุฉ **${trackToAdd.info.title}** ุฅูู ูุงุฆูุฉ ุงูุงูุชุธุงุฑ.`;
             }


            await interaction.editReply({ content: replyMessage });

            // ุจุฏุก ุงูุชุดุบูู ุฅุฐุง ูู ููู ูุนูู ุจุงููุนู ุฃู ูุชููู ูุคูุชูุง
           if (player.state !== Constants.PLAYER_STATE.PLAYING && player.state !== Constants.PLAYER_STATE.PAUSED) {
               await player.play();
           }

        } catch (error) {
            console.error('[Play Command Error]', error);
            // ุงุณุชุฎุฏุงู editReply ุจุฃูุงู ุญุชู ูู ุญุฏุซ ุฎุทุฃ ุจุนุฏ ุงูุชุฃุฌูู
           await interaction.editReply({ content: `ุญุฏุซ ุฎุทุฃ: ${error.message}` }).catch(()=>{});
            // ุงุฎุชูุงุฑู: ุชุฏููุฑ ุงููุดุบู ุฅุฐุง ูุดู ุงูุงุชุตุงู / ุงูุชุดุบูู ุงูุฃููู ุจุดูู ุญุฑุฌ
            // if (player && !player.connected && player.state !== Constants.PLAYER_STATE.PLAYING) {
           //     await player.destroy().catch(()=>{});
           // }
        }
    }
    // ุฃุถู ุงููุฒูุฏ ูู ุงูุฃูุงูุฑ ููุง (ุชุฎุทูุ ุฅููุงู ูุคูุชุ ุฅููุงูุ ุนุฑุถ ุงููุงุฆูุฉุ ุญุฌู ุงูุตูุชุ ุชูุฑุงุฑุ ุฅูุฎ)
});

// --- ุชุณุฌูู ุงูุฏุฎูู ---
client.login('YOUR_BOT_TOKEN'); // ุงุณุชุจุฏู ูุฐุง ุจุงูุชููู ุงูุฎุงุต ุจุจูุช ุฏูุณููุฑุฏ ุงูุฎุงุต ุจู
```

---

## ๐ ุงูุฃุญุฏุงุซ ุงููุฏุนููุฉ  

```js
 ุชุตุฏุฑ royal-lava ุฃุญุฏุงุซูุง ูุชููุนุฉ ุนุจุฑ ูุงุฆู ุงููุฏูุฑ (Manager). ุงุณุชุฎุฏู Constants.CLIENT_EVENT_TYPES ูุฃุณูุงุก ุงูุฃุญุฏุงุซ:

ุฃุญุฏุงุซ ุงูุณูุฑูุฑ (Node):

NODE_CONNECT (node): ูุตุฏุฑ ุนูุฏ ุฅูุดุงุก ุงุชุตุงู WebSocket ููุณูุฑูุฑ ุจูุฌุงุญ.
NODE_READY (node): ูุตุฏุฑ ุนูุฏูุง ูุจูุบ ุงูุณูุฑูุฑ ุนู ุฌุงูุฒูุชู (ูุณุชูู ูุนุฑูู ุงูุฌูุณุฉุ ูุคูุฏ ุงูุงุชุตุงู/ุงูุงุณุชุฆูุงู).
NODE_DISCONNECT (node, code, reason): ูุตุฏุฑ ุนูุฏ ุฅุบูุงู ุงุชุตุงู WebSocket ููุณูุฑูุฑ.
NODE_ERROR (node, error, context): ูุตุฏุฑ ุนูุฏ ุญุฏูุซ ุฃุฎุทุงุก WebSocket ุฃู REST ูุชุนููุฉ ุจุงูุณูุฑูุฑ. ูุฏ ูููุฑ context ูุฒูุฏูุง ูู ุงูุชูุงุตูู (ูุซู ุงูุนูููุฉ ุงููุงุดูุฉ).
NODE_STATS (node, stats): ูุตุฏุฑ ุจุดูู ุฏูุฑู ุนูุฏ ุงุณุชูุงู ุฅุญุตุงุฆูุงุช ุงูุณูุฑูุฑ.

ุฃุญุฏุงุซ ุงููุดุบู (Player):

PLAYER_CREATE (player): ูุตุฏุฑ ุนูุฏ ุฅูุดุงุก ูุงุฆู ูุดุบู ุฌุฏูุฏ.
PLAYER_DESTROY (player): ูุตุฏุฑ ุนูุฏ ุชุฏููุฑ ูุงุฆู ูุดุบู (ูุญูููุง).
PLAYER_MOVE (player, oldNode, newNode): ูุตุฏุฑ ุนูุฏ ููู ูุดุบู ุจูุฌุงุญ ุฅูู ุณูุฑูุฑ ูุฎุชูู.
PLAYER_STATE_UPDATE (player, state): ูุตุฏุฑ ุนูุฏูุง ูุฑุณู Lavalink ุชุญุฏูุซูุง ูุญุงูุฉ ุงููุดุบู (ุงูููุถุนุ ุฒูู ุงูุงุณุชุฌุงุจุฉ pingุ ุญุงูุฉ ุงูุงุชุตุงู).
PLAYER_WEBSOCKET_CLOSED (player, payload): ูุตุฏุฑ ุนูุฏ ุฅุบูุงู ุงุชุตุงู WebSocket ุงูุตูุชู ูุฏูุณููุฑุฏ ูููุดุบู (ููุง ุชู ุงูุฅุจูุงุบ ุนูู ุจูุงุณุทุฉ Lavalink).

ุฃุญุฏุงุซ ุงูุฃุบุงูู ูุงููุงุฆูุฉ (Track & Queue):

TRACK_START (player, track): ูุตุฏุฑ ุนูุฏ ุจุฏุก ุชุดุบูู ุฃุบููุฉ.
TRACK_END (player, track, payload): ูุตุฏุฑ ุนูุฏ ุงูุชูุงุก ุฃุบููุฉ ุฃู ุฅููุงููุง ุฃู ุงุณุชุจุฏุงููุง. ูุญุชูู payload ุนูู ุงูุณุจุจ. ูุฏ ูููู track ูุงุฑุบูุง (null) ุฅุฐุง ูู ููู ูุชุงุญูุง.
TRACK_EXCEPTION (player, track, error): ูุตุฏุฑ ุนูุฏ ุญุฏูุซ ุฎุทุฃ ุฃุซูุงุก ุชุดุบูู ุฃุบููุฉ (ูุซู ุฎุทุฃ ูู ูู ุงูุชุดููุฑ). ูุฏ ูููู track ูุงุฑุบูุง.
TRACK_STUCK (player, track, thresholdMs): ูุตุฏุฑ ุฅุฐุง ุนููุช ุฃุบููุฉ ููู ุชุชูุฏู ูููุฏุฉ ุงููุญุฏุฏุฉ. ูุฏ ูููู track ูุงุฑุบูุง.
QUEUE_END (player): ูุตุฏุฑ ุนูุฏ ุงูุชูุงุก ูุงุฆูุฉ ุงูุงูุชุธุงุฑ ูุนุฏู ูุฌูุฏ ูุถุน ุชูุฑุงุฑ ูุดุท ูุณุชูุฑ ูู ุงูุชุดุบูู.

ุฃุญุฏุงุซ ุฃุฎุฑู:

DEBUG (message, ...optionalArgs): ูุตุฏุฑ ููุญุตูู ุนูู ูุนูููุงุช ุชุตุญูุญ ุงูุฃุฎุทุงุก ุงูุฏุงุฎููุฉ.
```

---

## ๐ ููุงุญุธุงุช  
- ููุชุจุฉ **Royal-Lava** ุชุฑูุฒ ุนูู ุงูุฃุฏุงุก ุงูุนุงูู ูุงูุงุณุชูุฑุงุฑ.  
- ูุชู ุชุญุฏูุซูุง ุจุงุณุชูุฑุงุฑ ูุฏุนู ุฃุญุฏุซ ุฅุตุฏุงุฑุงุช Lavalink ู Discord.js.  
